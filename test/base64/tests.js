window.TESTRUN_SUITES = { 
'app_test':'KGZ1bmN0aW9uKCl7ZnVuY3Rpb24gcihlLG4sdCl7ZnVuY3Rpb24gbyhpLGYpe2lmKCFuW2ldKXtp ZighZVtpXSl7dmFyIGM9ImZ1bmN0aW9uIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmU7aWYoIWYm JmMpcmV0dXJuIGMoaSwhMCk7aWYodSlyZXR1cm4gdShpLCEwKTt2YXIgYT1uZXcgRXJyb3IoIkNh bm5vdCBmaW5kIG1vZHVsZSAnIitpKyInIik7dGhyb3cgYS5jb2RlPSJNT0RVTEVfTk9UX0ZPVU5E IixhfXZhciBwPW5baV09e2V4cG9ydHM6e319O2VbaV1bMF0uY2FsbChwLmV4cG9ydHMsZnVuY3Rp b24ocil7dmFyIG49ZVtpXVsxXVtyXTtyZXR1cm4gbyhufHxyKX0scCxwLmV4cG9ydHMscixlLG4s dCl9cmV0dXJuIG5baV0uZXhwb3J0c31mb3IodmFyIHU9ImZ1bmN0aW9uIj09dHlwZW9mIHJlcXVp cmUmJnJlcXVpcmUsaT0wO2k8dC5sZW5ndGg7aSsrKW8odFtpXSk7cmV0dXJuIG99cmV0dXJuIHJ9 KSgpKHsxOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKInVzZSBzdHJpY3QiOwp2 YXIgX19leHRlbmRzID0gKHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7 CiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7CiAgICAgICAgZXh0ZW5k U3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAogICAgICAgICAgICAoeyBfX3Byb3Rv X186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9f XyA9IGI7IH0pIHx8CiAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4g YikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9OwogICAgICAgIHJldHVy biBleHRlbmRTdGF0aWNzKGQsIGIpOwogICAgfTsKICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikg ewogICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRo aXMuY29uc3RydWN0b3IgPSBkOyB9CiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8g T2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkp OwogICAgfTsKfSkoKTsKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxl IiwgeyB2YWx1ZTogdHJ1ZSB9KTsKdmFyIHN0cmluZ2lmeSA9IHJlcXVpcmUoImpzb24tc3RyaW5n aWZ5LXNhZmUiKTsKdmFyIGRlZXBFcXVhbCA9IHJlcXVpcmUoImRlZXAtZXF1YWwiKTsKLyoqCiAq IFBvc2l0aXZlIHZhbHVlIG1hdGNoZXIuCiAqLwp2YXIgUG9zaXRpdmUgPSAvKiogQGNsYXNzICov IChmdW5jdGlvbiAoKSB7CiAgICBmdW5jdGlvbiBQb3NpdGl2ZSh2YWx1ZSwgdGhyb3dFcnJvcnMp IHsKICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7CiAgICAgICAgdGhpcy50aHJvd0Vycm9ycyA9 IHRocm93RXJyb3JzOwogICAgICAgIHRoaXMucHJlZml4ID0gJ211c3QnOwogICAgfQogICAgT2Jq ZWN0LmRlZmluZVByb3BlcnR5KFBvc2l0aXZlLnByb3RvdHlwZSwgImJlIiwgewogICAgICAgIGdl dDogZnVuY3Rpb24gKCkgewogICAgICAgICAgICByZXR1cm4gdGhpczsKICAgICAgICB9LAogICAg ICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlCiAgICB9KTsK ICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShQb3NpdGl2ZS5wcm90b3R5cGUsICJub3QiLCB7CiAg ICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHJldHVybiBuZXcgTmVnYXRpdmUo dGhpcy52YWx1ZSwgdGhpcy50aHJvd0Vycm9ycyk7CiAgICAgICAgfSwKICAgICAgICBlbnVtZXJh YmxlOiB0cnVlLAogICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZQogICAgfSk7CiAgICBPYmplY3Qu ZGVmaW5lUHJvcGVydHkoUG9zaXRpdmUucHJvdG90eXBlLCAiaW5zdGFuY2UiLCB7CiAgICAgICAg Z2V0OiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzOwogICAgICAgIH0sCiAg ICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICBjb25maWd1cmFibGU6IHRydWUKICAgIH0p OwogICAgUG9zaXRpdmUucHJvdG90eXBlLmFzc2VydCA9IGZ1bmN0aW9uIChvaywgY29uZGl0aW9u KSB7CiAgICAgICAgaWYgKCFvaykgewogICAgICAgICAgICBpZiAodGhpcy50aHJvd0Vycm9ycykK ICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigiVGhlIHZhbHVlICIgKyBleHBvcnRzLnRv U3RyaW5nKHRoaXMudmFsdWUpICsgIiAiICsgdGhpcy5wcmVmaXggKyAiICIgKwogICAgICAgICAg ICAgICAgICAgIChjb25kaXRpb24gKyAiISIpKTsKICAgICAgICAgICAgcmV0dXJuIG5ldyBGYWls ZWQodGhpcy52YWx1ZSwgdGhpcy50aHJvd0Vycm9ycyk7CiAgICAgICAgfQogICAgICAgIHJldHVy biB0aGlzOwogICAgfTsKICAgIFBvc2l0aXZlLnByb3RvdHlwZS5vZiA9IGZ1bmN0aW9uIChjb25z KSB7CiAgICAgICAgcmV0dXJuIHRoaXMuYXNzZXJ0KCh0aGlzLnZhbHVlIGluc3RhbmNlb2YgY29u cyksICJiZSBpbnN0YW5jZW9mICIgKyBjb25zLm5hbWUpOwogICAgfTsKICAgIFBvc2l0aXZlLnBy b3RvdHlwZS5vYmplY3QgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuYXNzZXJ0 KCgodHlwZW9mIHRoaXMudmFsdWUgPT09ICdvYmplY3QnKSAmJgogICAgICAgICAgICAodGhpcy52 YWx1ZSAhPT0gbnVsbCkpLCAnYmUgdHlwZW9mIG9iamVjdCcpOwogICAgfTsKICAgIFBvc2l0aXZl LnByb3RvdHlwZS5hcnJheSA9IGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gdGhpcy5hc3Nl cnQoQXJyYXkuaXNBcnJheSh0aGlzLnZhbHVlKSwgJ2JlIGFuIGFycmF5Jyk7CiAgICB9OwogICAg UG9zaXRpdmUucHJvdG90eXBlLnN0cmluZyA9IGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4g dGhpcy5hc3NlcnQoKHR5cGVvZiB0aGlzLnZhbHVlID09PSAnc3RyaW5nJyksICdiZSB0eXBlb2Yg c3RyaW5nJyk7CiAgICB9OwogICAgUG9zaXRpdmUucHJvdG90eXBlLm51bWJlciA9IGZ1bmN0aW9u ICgpIHsKICAgICAgICByZXR1cm4gdGhpcy5hc3NlcnQoKHR5cGVvZiB0aGlzLnZhbHVlID09PSAn bnVtYmVyJyksICdiZSB0eXBlb2YgbnVtYmVyJyk7CiAgICB9OwogICAgUG9zaXRpdmUucHJvdG90 eXBlLmJvb2xlYW4gPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuYXNzZXJ0KCh0 eXBlb2YgdGhpcy52YWx1ZSA9PT0gJ2Jvb2xlYW4nKSwgJ2JlIHR5cGVvZiBib29sZWFuJyk7CiAg ICB9OwogICAgUG9zaXRpdmUucHJvdG90eXBlLnRydWUgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAg cmV0dXJuIHRoaXMuYXNzZXJ0KCh0aGlzLnZhbHVlID09PSB0cnVlKSwgJ2JlIHRydWUnKTsKICAg IH07CiAgICBQb3NpdGl2ZS5wcm90b3R5cGUuZmFsc2UgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAg cmV0dXJuIHRoaXMuYXNzZXJ0KCh0aGlzLnZhbHVlID09PSBmYWxzZSksICdiZSBmYWxzZScpOwog ICAgfTsKICAgIFBvc2l0aXZlLnByb3RvdHlwZS5udWxsID0gZnVuY3Rpb24gKCkgewogICAgICAg IHJldHVybiB0aGlzLmFzc2VydCh0aGlzLnZhbHVlID09PSBudWxsLCAnYmUgbnVsbCcpOwogICAg fTsKICAgIFBvc2l0aXZlLnByb3RvdHlwZS51bmRlZmluZWQgPSBmdW5jdGlvbiAoKSB7CiAgICAg ICAgcmV0dXJuIHRoaXMuYXNzZXJ0KCh0aGlzLnZhbHVlID09PSB1bmRlZmluZWQpLCAnYmUgdW5k ZWZpbmVkJyk7CiAgICB9OwogICAgUG9zaXRpdmUucHJvdG90eXBlLmVxdWFsID0gZnVuY3Rpb24g KGIpIHsKICAgICAgICByZXR1cm4gdGhpcy5hc3NlcnQodGhpcy52YWx1ZSA9PT0gYiwgImVxdWFs ICIgKyBleHBvcnRzLnRvU3RyaW5nKGIpKTsKICAgIH07CiAgICBQb3NpdGl2ZS5wcm90b3R5cGUu ZXF1YXRlID0gZnVuY3Rpb24gKGIpIHsKICAgICAgICByZXR1cm4gdGhpcy5hc3NlcnQoZGVlcEVx dWFsKHRoaXMudmFsdWUsIGIpLCAiZXF1YXRlICIgKyBleHBvcnRzLnRvU3RyaW5nKGIpKTsKICAg IH07CiAgICBQb3NpdGl2ZS5wcm90b3R5cGUudGhyb3cgPSBmdW5jdGlvbiAobWVzc2FnZSkgewog ICAgICAgIHZhciBvayA9IGZhbHNlOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHRoaXMudmFs dWUoKTsKICAgICAgICB9CiAgICAgICAgY2F0Y2ggKGUpIHsKICAgICAgICAgICAgaWYgKG1lc3Nh Z2UgIT0gbnVsbCkgewogICAgICAgICAgICAgICAgb2sgPSBlLm1lc3NhZ2UgPT09IG1lc3NhZ2U7 CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICBvayA9IHRy dWU7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIHRoaXMuYXNzZXJ0KG9r LCAidGhyb3cgIiArICgobWVzc2FnZSAhPSBudWxsKSA/IG1lc3NhZ2UgOiAnJykpOwogICAgfTsK ICAgIHJldHVybiBQb3NpdGl2ZTsKfSgpKTsKZXhwb3J0cy5Qb3NpdGl2ZSA9IFBvc2l0aXZlOwov KioKICogTmVnYXRpdmUgdmFsdWUgbWF0Y2hlci4KICovCnZhciBOZWdhdGl2ZSA9IC8qKiBAY2xh c3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKICAgIF9fZXh0ZW5kcyhOZWdhdGl2ZSwgX3N1cGVy KTsKICAgIGZ1bmN0aW9uIE5lZ2F0aXZlKCkgewogICAgICAgIHZhciBfdGhpcyA9IF9zdXBlciAh PT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwogICAgICAg IF90aGlzLnByZWZpeCA9ICdtdXN0IG5vdCc7CiAgICAgICAgcmV0dXJuIF90aGlzOwogICAgfQog ICAgTmVnYXRpdmUucHJvdG90eXBlLmFzc2VydCA9IGZ1bmN0aW9uIChvaywgY29uZGl0aW9uKSB7 CiAgICAgICAgcmV0dXJuIF9zdXBlci5wcm90b3R5cGUuYXNzZXJ0LmNhbGwodGhpcywgIW9rLCBj b25kaXRpb24pOwogICAgfTsKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShOZWdhdGl2ZS5wcm90 b3R5cGUsICJub3QiLCB7CiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHJl dHVybiBuZXcgUG9zaXRpdmUodGhpcy52YWx1ZSwgdGhpcy50aHJvd0Vycm9ycyk7IC8vIG5vdCBu b3QgPT0gdHJ1ZQogICAgICAgIH0sCiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICBj b25maWd1cmFibGU6IHRydWUKICAgIH0pOwogICAgcmV0dXJuIE5lZ2F0aXZlOwp9KFBvc2l0aXZl KSk7CmV4cG9ydHMuTmVnYXRpdmUgPSBOZWdhdGl2ZTsKLyoqCiAqIEZhaWxlZCBtYXRjaGVyLgog Ki8KdmFyIEZhaWxlZCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKICAgIF9f ZXh0ZW5kcyhGYWlsZWQsIF9zdXBlcik7CiAgICBmdW5jdGlvbiBGYWlsZWQoKSB7CiAgICAgICAg cmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8 fCB0aGlzOwogICAgfQogICAgRmFpbGVkLnByb3RvdHlwZS5hc3NlcnQgPSBmdW5jdGlvbiAoXywg X18pIHsKICAgICAgICByZXR1cm4gdGhpczsKICAgIH07CiAgICByZXR1cm4gRmFpbGVkOwp9KFBv c2l0aXZlKSk7CmV4cG9ydHMuRmFpbGVkID0gRmFpbGVkOwovKioKICogQHByaXZhdGUKICovCmV4 cG9ydHMudG9TdHJpbmcgPSBmdW5jdGlvbiAodmFsdWUpIHsKICAgIGlmICh0eXBlb2YgdmFsdWUg PT09ICdmdW5jdGlvbicpIHsKICAgICAgICByZXR1cm4gdmFsdWUubmFtZTsKICAgIH0KICAgIGVs c2UgaWYgKHZhbHVlIGluc3RhbmNlb2YgRGF0ZSkgewogICAgICAgIHJldHVybiB2YWx1ZS50b0lT T1N0cmluZygpOwogICAgfQogICAgZWxzZSBpZiAodmFsdWUgaW5zdGFuY2VvZiBSZWdFeHApIHsK ICAgICAgICByZXR1cm4gdmFsdWUudG9TdHJpbmcoKTsKICAgIH0KICAgIGVsc2UgaWYgKHR5cGVv ZiB2YWx1ZSA9PT0gJ29iamVjdCcpIHsKICAgICAgICBpZiAoKHZhbHVlLmNvbnN0cnVjdG9yICE9 PSBPYmplY3QpICYmICghQXJyYXkuaXNBcnJheSh2YWx1ZSkpKQogICAgICAgICAgICByZXR1cm4g dmFsdWUuY29uc3RydWN0b3IubmFtZTsKICAgICAgICBlbHNlCiAgICAgICAgICAgIHJldHVybiBz dHJpbmdpZnkodmFsdWUpOwogICAgfQogICAgcmV0dXJuIHN0cmluZ2lmeSh2YWx1ZSk7Cn07Ci8q KgogKiBhc3NlcnQgdHVybnMgYSB2YWx1ZSBpbnRvIGEgTWF0Y2hlciBzbyBpdCBjYW4gYmUgdGVz dGVkLgogKgogKiBUaGUgTWF0Y2hlciByZXR1cm5lZCBpcyBwb3NpdGl2ZSBhbmQgY29uZmlndXJl ZCB0byB0aHJvdwogKiBlcnJvcnMgaWYgYW55IHRlc3RzIGZhaWwuCiAqLwpleHBvcnRzLmFzc2Vy dCA9IGZ1bmN0aW9uICh2YWx1ZSkgeyByZXR1cm4gbmV3IFBvc2l0aXZlKHZhbHVlLCB0cnVlKTsg fTsKCn0seyJkZWVwLWVxdWFsIjoyLCJqc29uLXN0cmluZ2lmeS1zYWZlIjoxMH1dLDI6W2Z1bmN0 aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewp2YXIgb2JqZWN0S2V5cyA9IHJlcXVpcmUoJ29i amVjdC1rZXlzJyk7CnZhciBpc0FyZ3VtZW50cyA9IHJlcXVpcmUoJ2lzLWFyZ3VtZW50cycpOwp2 YXIgaXMgPSByZXF1aXJlKCdvYmplY3QtaXMnKTsKdmFyIGlzUmVnZXggPSByZXF1aXJlKCdpcy1y ZWdleCcpOwp2YXIgZmxhZ3MgPSByZXF1aXJlKCdyZWdleHAucHJvdG90eXBlLmZsYWdzJyk7CnZh ciBpc0RhdGUgPSByZXF1aXJlKCdpcy1kYXRlLW9iamVjdCcpOwoKdmFyIGdldFRpbWUgPSBEYXRl LnByb3RvdHlwZS5nZXRUaW1lOwoKZnVuY3Rpb24gZGVlcEVxdWFsKGFjdHVhbCwgZXhwZWN0ZWQs IG9wdGlvbnMpIHsKICB2YXIgb3B0cyA9IG9wdGlvbnMgfHwge307CgogIC8vIDcuMS4gQWxsIGlk ZW50aWNhbCB2YWx1ZXMgYXJlIGVxdWl2YWxlbnQsIGFzIGRldGVybWluZWQgYnkgPT09LgogIGlm IChvcHRzLnN0cmljdCA/IGlzKGFjdHVhbCwgZXhwZWN0ZWQpIDogYWN0dWFsID09PSBleHBlY3Rl ZCkgewogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvLyA3LjMuIE90aGVyIHBhaXJzIHRoYXQgZG8g bm90IGJvdGggcGFzcyB0eXBlb2YgdmFsdWUgPT0gJ29iamVjdCcsIGVxdWl2YWxlbmNlIGlzIGRl dGVybWluZWQgYnkgPT0uCiAgaWYgKCFhY3R1YWwgfHwgIWV4cGVjdGVkIHx8ICh0eXBlb2YgYWN0 dWFsICE9PSAnb2JqZWN0JyAmJiB0eXBlb2YgZXhwZWN0ZWQgIT09ICdvYmplY3QnKSkgewogICAg cmV0dXJuIG9wdHMuc3RyaWN0ID8gaXMoYWN0dWFsLCBleHBlY3RlZCkgOiBhY3R1YWwgPT0gZXhw ZWN0ZWQ7CiAgfQoKICAvKgogICAqIDcuNC4gRm9yIGFsbCBvdGhlciBPYmplY3QgcGFpcnMsIGlu Y2x1ZGluZyBBcnJheSBvYmplY3RzLCBlcXVpdmFsZW5jZSBpcwogICAqIGRldGVybWluZWQgYnkg aGF2aW5nIHRoZSBzYW1lIG51bWJlciBvZiBvd25lZCBwcm9wZXJ0aWVzIChhcyB2ZXJpZmllZAog ICAqIHdpdGggT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKSwgdGhlIHNhbWUg c2V0IG9mIGtleXMKICAgKiAoYWx0aG91Z2ggbm90IG5lY2Vzc2FyaWx5IHRoZSBzYW1lIG9yZGVy KSwgZXF1aXZhbGVudCB2YWx1ZXMgZm9yIGV2ZXJ5CiAgICogY29ycmVzcG9uZGluZyBrZXksIGFu ZCBhbiBpZGVudGljYWwgJ3Byb3RvdHlwZScgcHJvcGVydHkuIE5vdGU6IHRoaXMKICAgKiBhY2Nv dW50cyBmb3IgYm90aCBuYW1lZCBhbmQgaW5kZXhlZCBwcm9wZXJ0aWVzIG9uIEFycmF5cy4KICAg Ki8KICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdXNlLWJlZm9yZS1kZWZpbmUKICBy ZXR1cm4gb2JqRXF1aXYoYWN0dWFsLCBleHBlY3RlZCwgb3B0cyk7Cn0KCmZ1bmN0aW9uIGlzVW5k ZWZpbmVkT3JOdWxsKHZhbHVlKSB7CiAgcmV0dXJuIHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09 PSB1bmRlZmluZWQ7Cn0KCmZ1bmN0aW9uIGlzQnVmZmVyKHgpIHsKICBpZiAoIXggfHwgdHlwZW9m IHggIT09ICdvYmplY3QnIHx8IHR5cGVvZiB4Lmxlbmd0aCAhPT0gJ251bWJlcicpIHsKICAgIHJl dHVybiBmYWxzZTsKICB9CiAgaWYgKHR5cGVvZiB4LmNvcHkgIT09ICdmdW5jdGlvbicgfHwgdHlw ZW9mIHguc2xpY2UgIT09ICdmdW5jdGlvbicpIHsKICAgIHJldHVybiBmYWxzZTsKICB9CiAgaWYg KHgubGVuZ3RoID4gMCAmJiB0eXBlb2YgeFswXSAhPT0gJ251bWJlcicpIHsKICAgIHJldHVybiBm YWxzZTsKICB9CiAgcmV0dXJuIHRydWU7Cn0KCmZ1bmN0aW9uIG9iakVxdWl2KGEsIGIsIG9wdHMp IHsKICAvKiBlc2xpbnQgbWF4LXN0YXRlbWVudHM6IFsyLCA1MF0gKi8KICB2YXIgaSwga2V5Owog IGlmICh0eXBlb2YgYSAhPT0gdHlwZW9mIGIpIHsgcmV0dXJuIGZhbHNlOyB9CiAgaWYgKGlzVW5k ZWZpbmVkT3JOdWxsKGEpIHx8IGlzVW5kZWZpbmVkT3JOdWxsKGIpKSB7IHJldHVybiBmYWxzZTsg fQoKICAvLyBhbiBpZGVudGljYWwgJ3Byb3RvdHlwZScgcHJvcGVydHkuCiAgaWYgKGEucHJvdG90 eXBlICE9PSBiLnByb3RvdHlwZSkgeyByZXR1cm4gZmFsc2U7IH0KCiAgaWYgKGlzQXJndW1lbnRz KGEpICE9PSBpc0FyZ3VtZW50cyhiKSkgeyByZXR1cm4gZmFsc2U7IH0KCiAgdmFyIGFJc1JlZ2V4 ID0gaXNSZWdleChhKTsKICB2YXIgYklzUmVnZXggPSBpc1JlZ2V4KGIpOwogIGlmIChhSXNSZWdl eCAhPT0gYklzUmVnZXgpIHsgcmV0dXJuIGZhbHNlOyB9CiAgaWYgKGFJc1JlZ2V4IHx8IGJJc1Jl Z2V4KSB7CiAgICByZXR1cm4gYS5zb3VyY2UgPT09IGIuc291cmNlICYmIGZsYWdzKGEpID09PSBm bGFncyhiKTsKICB9CgogIGlmIChpc0RhdGUoYSkgJiYgaXNEYXRlKGIpKSB7CiAgICByZXR1cm4g Z2V0VGltZS5jYWxsKGEpID09PSBnZXRUaW1lLmNhbGwoYik7CiAgfQoKICB2YXIgYUlzQnVmZmVy ID0gaXNCdWZmZXIoYSk7CiAgdmFyIGJJc0J1ZmZlciA9IGlzQnVmZmVyKGIpOwogIGlmIChhSXNC dWZmZXIgIT09IGJJc0J1ZmZlcikgeyByZXR1cm4gZmFsc2U7IH0KICBpZiAoYUlzQnVmZmVyIHx8 IGJJc0J1ZmZlcikgeyAvLyAmJiB3b3VsZCB3b3JrIHRvbywgYmVjYXVzZSBib3RoIGFyZSB0cnVl IG9yIGJvdGggZmFsc2UgaGVyZQogICAgaWYgKGEubGVuZ3RoICE9PSBiLmxlbmd0aCkgeyByZXR1 cm4gZmFsc2U7IH0KICAgIGZvciAoaSA9IDA7IGkgPCBhLmxlbmd0aDsgaSsrKSB7CiAgICAgIGlm IChhW2ldICE9PSBiW2ldKSB7IHJldHVybiBmYWxzZTsgfQogICAgfQogICAgcmV0dXJuIHRydWU7 CiAgfQoKICBpZiAodHlwZW9mIGEgIT09IHR5cGVvZiBiKSB7IHJldHVybiBmYWxzZTsgfQoKICB0 cnkgewogICAgdmFyIGthID0gb2JqZWN0S2V5cyhhKTsKICAgIHZhciBrYiA9IG9iamVjdEtleXMo Yik7CiAgfSBjYXRjaCAoZSkgeyAvLyBoYXBwZW5zIHdoZW4gb25lIGlzIGEgc3RyaW5nIGxpdGVy YWwgYW5kIHRoZSBvdGhlciBpc24ndAogICAgcmV0dXJuIGZhbHNlOwogIH0KICAvLyBoYXZpbmcg dGhlIHNhbWUgbnVtYmVyIG9mIG93bmVkIHByb3BlcnRpZXMgKGtleXMgaW5jb3Jwb3JhdGVzIGhh c093blByb3BlcnR5KQogIGlmIChrYS5sZW5ndGggIT09IGtiLmxlbmd0aCkgeyByZXR1cm4gZmFs c2U7IH0KCiAgLy8gdGhlIHNhbWUgc2V0IG9mIGtleXMgKGFsdGhvdWdoIG5vdCBuZWNlc3Nhcmls eSB0aGUgc2FtZSBvcmRlciksCiAga2Euc29ydCgpOwogIGtiLnNvcnQoKTsKICAvLyB+fn5jaGVh cCBrZXkgdGVzdAogIGZvciAoaSA9IGthLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7CiAgICBp ZiAoa2FbaV0gIT0ga2JbaV0pIHsgcmV0dXJuIGZhbHNlOyB9CiAgfQogIC8vIGVxdWl2YWxlbnQg dmFsdWVzIGZvciBldmVyeSBjb3JyZXNwb25kaW5nIGtleSwgYW5kIH5+fnBvc3NpYmx5IGV4cGVu c2l2ZSBkZWVwIHRlc3QKICBmb3IgKGkgPSBrYS5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgewog ICAga2V5ID0ga2FbaV07CiAgICBpZiAoIWRlZXBFcXVhbChhW2tleV0sIGJba2V5XSwgb3B0cykp IHsgcmV0dXJuIGZhbHNlOyB9CiAgfQoKICByZXR1cm4gdHJ1ZTsKfQoKbW9kdWxlLmV4cG9ydHMg PSBkZWVwRXF1YWw7Cgp9LHsiaXMtYXJndW1lbnRzIjo3LCJpcy1kYXRlLW9iamVjdCI6OCwiaXMt cmVnZXgiOjksIm9iamVjdC1pcyI6MTEsIm9iamVjdC1rZXlzIjoxMywicmVnZXhwLnByb3RvdHlw ZS5mbGFncyI6MTZ9XSwzOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKJ3VzZSBz dHJpY3QnOwoKdmFyIGtleXMgPSByZXF1aXJlKCdvYmplY3Qta2V5cycpOwp2YXIgaGFzU3ltYm9s cyA9IHR5cGVvZiBTeW1ib2wgPT09ICdmdW5jdGlvbicgJiYgdHlwZW9mIFN5bWJvbCgnZm9vJykg PT09ICdzeW1ib2wnOwoKdmFyIHRvU3RyID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZzsKdmFy IGNvbmNhdCA9IEFycmF5LnByb3RvdHlwZS5jb25jYXQ7CnZhciBvcmlnRGVmaW5lUHJvcGVydHkg PSBPYmplY3QuZGVmaW5lUHJvcGVydHk7Cgp2YXIgaXNGdW5jdGlvbiA9IGZ1bmN0aW9uIChmbikg ewoJcmV0dXJuIHR5cGVvZiBmbiA9PT0gJ2Z1bmN0aW9uJyAmJiB0b1N0ci5jYWxsKGZuKSA9PT0g J1tvYmplY3QgRnVuY3Rpb25dJzsKfTsKCnZhciBhcmVQcm9wZXJ0eURlc2NyaXB0b3JzU3VwcG9y dGVkID0gZnVuY3Rpb24gKCkgewoJdmFyIG9iaiA9IHt9OwoJdHJ5IHsKCQlvcmlnRGVmaW5lUHJv cGVydHkob2JqLCAneCcsIHsgZW51bWVyYWJsZTogZmFsc2UsIHZhbHVlOiBvYmogfSk7CgkJLy8g ZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXVudXNlZC12YXJzLCBuby1yZXN0cmljdGVkLXN5 bnRheAoJCWZvciAodmFyIF8gaW4gb2JqKSB7IC8vIGpzY3M6aWdub3JlIGRpc2FsbG93VW51c2Vk VmFyaWFibGVzCgkJCXJldHVybiBmYWxzZTsKCQl9CgkJcmV0dXJuIG9iai54ID09PSBvYmo7Cgl9 IGNhdGNoIChlKSB7IC8qIHRoaXMgaXMgSUUgOC4gKi8KCQlyZXR1cm4gZmFsc2U7Cgl9Cn07CnZh ciBzdXBwb3J0c0Rlc2NyaXB0b3JzID0gb3JpZ0RlZmluZVByb3BlcnR5ICYmIGFyZVByb3BlcnR5 RGVzY3JpcHRvcnNTdXBwb3J0ZWQoKTsKCnZhciBkZWZpbmVQcm9wZXJ0eSA9IGZ1bmN0aW9uIChv YmplY3QsIG5hbWUsIHZhbHVlLCBwcmVkaWNhdGUpIHsKCWlmIChuYW1lIGluIG9iamVjdCAmJiAo IWlzRnVuY3Rpb24ocHJlZGljYXRlKSB8fCAhcHJlZGljYXRlKCkpKSB7CgkJcmV0dXJuOwoJfQoJ aWYgKHN1cHBvcnRzRGVzY3JpcHRvcnMpIHsKCQlvcmlnRGVmaW5lUHJvcGVydHkob2JqZWN0LCBu YW1lLCB7CgkJCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKCQkJZW51bWVyYWJsZTogZmFsc2UsCgkJCXZh bHVlOiB2YWx1ZSwKCQkJd3JpdGFibGU6IHRydWUKCQl9KTsKCX0gZWxzZSB7CgkJb2JqZWN0W25h bWVdID0gdmFsdWU7Cgl9Cn07Cgp2YXIgZGVmaW5lUHJvcGVydGllcyA9IGZ1bmN0aW9uIChvYmpl Y3QsIG1hcCkgewoJdmFyIHByZWRpY2F0ZXMgPSBhcmd1bWVudHMubGVuZ3RoID4gMiA/IGFyZ3Vt ZW50c1syXSA6IHt9OwoJdmFyIHByb3BzID0ga2V5cyhtYXApOwoJaWYgKGhhc1N5bWJvbHMpIHsK CQlwcm9wcyA9IGNvbmNhdC5jYWxsKHByb3BzLCBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xz KG1hcCkpOwoJfQoJZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkgKz0gMSkgewoJ CWRlZmluZVByb3BlcnR5KG9iamVjdCwgcHJvcHNbaV0sIG1hcFtwcm9wc1tpXV0sIHByZWRpY2F0 ZXNbcHJvcHNbaV1dKTsKCX0KfTsKCmRlZmluZVByb3BlcnRpZXMuc3VwcG9ydHNEZXNjcmlwdG9y cyA9ICEhc3VwcG9ydHNEZXNjcmlwdG9yczsKCm1vZHVsZS5leHBvcnRzID0gZGVmaW5lUHJvcGVy dGllczsKCn0seyJvYmplY3Qta2V5cyI6MTN9XSw0OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxl eHBvcnRzKXsKJ3VzZSBzdHJpY3QnOwoKLyogZXNsaW50IG5vLWludmFsaWQtdGhpczogMSAqLwoK dmFyIEVSUk9SX01FU1NBR0UgPSAnRnVuY3Rpb24ucHJvdG90eXBlLmJpbmQgY2FsbGVkIG9uIGlu Y29tcGF0aWJsZSAnOwp2YXIgc2xpY2UgPSBBcnJheS5wcm90b3R5cGUuc2xpY2U7CnZhciB0b1N0 ciA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmc7CnZhciBmdW5jVHlwZSA9ICdbb2JqZWN0IEZ1 bmN0aW9uXSc7Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGJpbmQodGhhdCkgewogICAgdmFy IHRhcmdldCA9IHRoaXM7CiAgICBpZiAodHlwZW9mIHRhcmdldCAhPT0gJ2Z1bmN0aW9uJyB8fCB0 b1N0ci5jYWxsKHRhcmdldCkgIT09IGZ1bmNUeXBlKSB7CiAgICAgICAgdGhyb3cgbmV3IFR5cGVF cnJvcihFUlJPUl9NRVNTQUdFICsgdGFyZ2V0KTsKICAgIH0KICAgIHZhciBhcmdzID0gc2xpY2Uu Y2FsbChhcmd1bWVudHMsIDEpOwoKICAgIHZhciBib3VuZDsKICAgIHZhciBiaW5kZXIgPSBmdW5j dGlvbiAoKSB7CiAgICAgICAgaWYgKHRoaXMgaW5zdGFuY2VvZiBib3VuZCkgewogICAgICAgICAg ICB2YXIgcmVzdWx0ID0gdGFyZ2V0LmFwcGx5KAogICAgICAgICAgICAgICAgdGhpcywKICAgICAg ICAgICAgICAgIGFyZ3MuY29uY2F0KHNsaWNlLmNhbGwoYXJndW1lbnRzKSkKICAgICAgICAgICAg KTsKICAgICAgICAgICAgaWYgKE9iamVjdChyZXN1bHQpID09PSByZXN1bHQpIHsKICAgICAgICAg ICAgICAgIHJldHVybiByZXN1bHQ7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIHRo aXM7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuIHRhcmdldC5hcHBseSgKICAg ICAgICAgICAgICAgIHRoYXQsCiAgICAgICAgICAgICAgICBhcmdzLmNvbmNhdChzbGljZS5jYWxs KGFyZ3VtZW50cykpCiAgICAgICAgICAgICk7CiAgICAgICAgfQogICAgfTsKCiAgICB2YXIgYm91 bmRMZW5ndGggPSBNYXRoLm1heCgwLCB0YXJnZXQubGVuZ3RoIC0gYXJncy5sZW5ndGgpOwogICAg dmFyIGJvdW5kQXJncyA9IFtdOwogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBib3VuZExlbmd0aDsg aSsrKSB7CiAgICAgICAgYm91bmRBcmdzLnB1c2goJyQnICsgaSk7CiAgICB9CgogICAgYm91bmQg PSBGdW5jdGlvbignYmluZGVyJywgJ3JldHVybiBmdW5jdGlvbiAoJyArIGJvdW5kQXJncy5qb2lu KCcsJykgKyAnKXsgcmV0dXJuIGJpbmRlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7IH0nKShiaW5k ZXIpOwoKICAgIGlmICh0YXJnZXQucHJvdG90eXBlKSB7CiAgICAgICAgdmFyIEVtcHR5ID0gZnVu Y3Rpb24gRW1wdHkoKSB7fTsKICAgICAgICBFbXB0eS5wcm90b3R5cGUgPSB0YXJnZXQucHJvdG90 eXBlOwogICAgICAgIGJvdW5kLnByb3RvdHlwZSA9IG5ldyBFbXB0eSgpOwogICAgICAgIEVtcHR5 LnByb3RvdHlwZSA9IG51bGw7CiAgICB9CgogICAgcmV0dXJuIGJvdW5kOwp9OwoKfSx7fV0sNTpb ZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7Cid1c2Ugc3RyaWN0JzsKCnZhciBpbXBs ZW1lbnRhdGlvbiA9IHJlcXVpcmUoJy4vaW1wbGVtZW50YXRpb24nKTsKCm1vZHVsZS5leHBvcnRz ID0gRnVuY3Rpb24ucHJvdG90eXBlLmJpbmQgfHwgaW1wbGVtZW50YXRpb247Cgp9LHsiLi9pbXBs ZW1lbnRhdGlvbiI6NH1dLDY6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewondXNl IHN0cmljdCc7Cgp2YXIgYmluZCA9IHJlcXVpcmUoJ2Z1bmN0aW9uLWJpbmQnKTsKCm1vZHVsZS5l eHBvcnRzID0gYmluZC5jYWxsKEZ1bmN0aW9uLmNhbGwsIE9iamVjdC5wcm90b3R5cGUuaGFzT3du UHJvcGVydHkpOwoKfSx7ImZ1bmN0aW9uLWJpbmQiOjV9XSw3OltmdW5jdGlvbihyZXF1aXJlLG1v ZHVsZSxleHBvcnRzKXsKJ3VzZSBzdHJpY3QnOwoKdmFyIGhhc1RvU3RyaW5nVGFnID0gdHlwZW9m IFN5bWJvbCA9PT0gJ2Z1bmN0aW9uJyAmJiB0eXBlb2YgU3ltYm9sLnRvU3RyaW5nVGFnID09PSAn c3ltYm9sJzsKdmFyIHRvU3RyID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZzsKCnZhciBpc1N0 YW5kYXJkQXJndW1lbnRzID0gZnVuY3Rpb24gaXNBcmd1bWVudHModmFsdWUpIHsKCWlmIChoYXNU b1N0cmluZ1RhZyAmJiB2YWx1ZSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIFN5bWJv bC50b1N0cmluZ1RhZyBpbiB2YWx1ZSkgewoJCXJldHVybiBmYWxzZTsKCX0KCXJldHVybiB0b1N0 ci5jYWxsKHZhbHVlKSA9PT0gJ1tvYmplY3QgQXJndW1lbnRzXSc7Cn07Cgp2YXIgaXNMZWdhY3lB cmd1bWVudHMgPSBmdW5jdGlvbiBpc0FyZ3VtZW50cyh2YWx1ZSkgewoJaWYgKGlzU3RhbmRhcmRB cmd1bWVudHModmFsdWUpKSB7CgkJcmV0dXJuIHRydWU7Cgl9CglyZXR1cm4gdmFsdWUgIT09IG51 bGwgJiYKCQl0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmCgkJdHlwZW9mIHZhbHVlLmxlbmd0 aCA9PT0gJ251bWJlcicgJiYKCQl2YWx1ZS5sZW5ndGggPj0gMCAmJgoJCXRvU3RyLmNhbGwodmFs dWUpICE9PSAnW29iamVjdCBBcnJheV0nICYmCgkJdG9TdHIuY2FsbCh2YWx1ZS5jYWxsZWUpID09 PSAnW29iamVjdCBGdW5jdGlvbl0nOwp9OwoKdmFyIHN1cHBvcnRzU3RhbmRhcmRBcmd1bWVudHMg PSAoZnVuY3Rpb24gKCkgewoJcmV0dXJuIGlzU3RhbmRhcmRBcmd1bWVudHMoYXJndW1lbnRzKTsK fSgpKTsKCmlzU3RhbmRhcmRBcmd1bWVudHMuaXNMZWdhY3lBcmd1bWVudHMgPSBpc0xlZ2FjeUFy Z3VtZW50czsgLy8gZm9yIHRlc3RzCgptb2R1bGUuZXhwb3J0cyA9IHN1cHBvcnRzU3RhbmRhcmRB cmd1bWVudHMgPyBpc1N0YW5kYXJkQXJndW1lbnRzIDogaXNMZWdhY3lBcmd1bWVudHM7Cgp9LHt9 XSw4OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKJ3VzZSBzdHJpY3QnOwoKdmFy IGdldERheSA9IERhdGUucHJvdG90eXBlLmdldERheTsKdmFyIHRyeURhdGVPYmplY3QgPSBmdW5j dGlvbiB0cnlEYXRlT2JqZWN0KHZhbHVlKSB7Cgl0cnkgewoJCWdldERheS5jYWxsKHZhbHVlKTsK CQlyZXR1cm4gdHJ1ZTsKCX0gY2F0Y2ggKGUpIHsKCQlyZXR1cm4gZmFsc2U7Cgl9Cn07Cgp2YXIg dG9TdHIgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nOwp2YXIgZGF0ZUNsYXNzID0gJ1tvYmpl Y3QgRGF0ZV0nOwp2YXIgaGFzVG9TdHJpbmdUYWcgPSB0eXBlb2YgU3ltYm9sID09PSAnZnVuY3Rp b24nICYmIHR5cGVvZiBTeW1ib2wudG9TdHJpbmdUYWcgPT09ICdzeW1ib2wnOwoKbW9kdWxlLmV4 cG9ydHMgPSBmdW5jdGlvbiBpc0RhdGVPYmplY3QodmFsdWUpIHsKCWlmICh0eXBlb2YgdmFsdWUg IT09ICdvYmplY3QnIHx8IHZhbHVlID09PSBudWxsKSB7IHJldHVybiBmYWxzZTsgfQoJcmV0dXJu IGhhc1RvU3RyaW5nVGFnID8gdHJ5RGF0ZU9iamVjdCh2YWx1ZSkgOiB0b1N0ci5jYWxsKHZhbHVl KSA9PT0gZGF0ZUNsYXNzOwp9OwoKfSx7fV0sOTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhw b3J0cyl7Cid1c2Ugc3RyaWN0JzsKCnZhciBoYXMgPSByZXF1aXJlKCdoYXMnKTsKdmFyIHJlZ2V4 RXhlYyA9IFJlZ0V4cC5wcm90b3R5cGUuZXhlYzsKdmFyIGdPUEQgPSBPYmplY3QuZ2V0T3duUHJv cGVydHlEZXNjcmlwdG9yOwoKdmFyIHRyeVJlZ2V4RXhlY0NhbGwgPSBmdW5jdGlvbiB0cnlSZWdl eEV4ZWModmFsdWUpIHsKCXRyeSB7CgkJdmFyIGxhc3RJbmRleCA9IHZhbHVlLmxhc3RJbmRleDsK CQl2YWx1ZS5sYXN0SW5kZXggPSAwOwoKCQlyZWdleEV4ZWMuY2FsbCh2YWx1ZSk7CgkJcmV0dXJu IHRydWU7Cgl9IGNhdGNoIChlKSB7CgkJcmV0dXJuIGZhbHNlOwoJfSBmaW5hbGx5IHsKCQl2YWx1 ZS5sYXN0SW5kZXggPSBsYXN0SW5kZXg7Cgl9Cn07CnZhciB0b1N0ciA9IE9iamVjdC5wcm90b3R5 cGUudG9TdHJpbmc7CnZhciByZWdleENsYXNzID0gJ1tvYmplY3QgUmVnRXhwXSc7CnZhciBoYXNU b1N0cmluZ1RhZyA9IHR5cGVvZiBTeW1ib2wgPT09ICdmdW5jdGlvbicgJiYgdHlwZW9mIFN5bWJv bC50b1N0cmluZ1RhZyA9PT0gJ3N5bWJvbCc7Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGlz UmVnZXgodmFsdWUpIHsKCWlmICghdmFsdWUgfHwgdHlwZW9mIHZhbHVlICE9PSAnb2JqZWN0Jykg ewoJCXJldHVybiBmYWxzZTsKCX0KCWlmICghaGFzVG9TdHJpbmdUYWcpIHsKCQlyZXR1cm4gdG9T dHIuY2FsbCh2YWx1ZSkgPT09IHJlZ2V4Q2xhc3M7Cgl9CgoJdmFyIGRlc2NyaXB0b3IgPSBnT1BE KHZhbHVlLCAnbGFzdEluZGV4Jyk7Cgl2YXIgaGFzTGFzdEluZGV4RGF0YVByb3BlcnR5ID0gZGVz Y3JpcHRvciAmJiBoYXMoZGVzY3JpcHRvciwgJ3ZhbHVlJyk7CglpZiAoIWhhc0xhc3RJbmRleERh dGFQcm9wZXJ0eSkgewoJCXJldHVybiBmYWxzZTsKCX0KCglyZXR1cm4gdHJ5UmVnZXhFeGVjQ2Fs bCh2YWx1ZSk7Cn07Cgp9LHsiaGFzIjo2fV0sMTA6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4 cG9ydHMpewpleHBvcnRzID0gbW9kdWxlLmV4cG9ydHMgPSBzdHJpbmdpZnkKZXhwb3J0cy5nZXRT ZXJpYWxpemUgPSBzZXJpYWxpemVyCgpmdW5jdGlvbiBzdHJpbmdpZnkob2JqLCByZXBsYWNlciwg c3BhY2VzLCBjeWNsZVJlcGxhY2VyKSB7CiAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KG9iaiwgc2Vy aWFsaXplcihyZXBsYWNlciwgY3ljbGVSZXBsYWNlciksIHNwYWNlcykKfQoKZnVuY3Rpb24gc2Vy aWFsaXplcihyZXBsYWNlciwgY3ljbGVSZXBsYWNlcikgewogIHZhciBzdGFjayA9IFtdLCBrZXlz ID0gW10KCiAgaWYgKGN5Y2xlUmVwbGFjZXIgPT0gbnVsbCkgY3ljbGVSZXBsYWNlciA9IGZ1bmN0 aW9uKGtleSwgdmFsdWUpIHsKICAgIGlmIChzdGFja1swXSA9PT0gdmFsdWUpIHJldHVybiAiW0Np cmN1bGFyIH5dIgogICAgcmV0dXJuICJbQ2lyY3VsYXIgfi4iICsga2V5cy5zbGljZSgwLCBzdGFj ay5pbmRleE9mKHZhbHVlKSkuam9pbigiLiIpICsgIl0iCiAgfQoKICByZXR1cm4gZnVuY3Rpb24o a2V5LCB2YWx1ZSkgewogICAgaWYgKHN0YWNrLmxlbmd0aCA+IDApIHsKICAgICAgdmFyIHRoaXNQ b3MgPSBzdGFjay5pbmRleE9mKHRoaXMpCiAgICAgIH50aGlzUG9zID8gc3RhY2suc3BsaWNlKHRo aXNQb3MgKyAxKSA6IHN0YWNrLnB1c2godGhpcykKICAgICAgfnRoaXNQb3MgPyBrZXlzLnNwbGlj ZSh0aGlzUG9zLCBJbmZpbml0eSwga2V5KSA6IGtleXMucHVzaChrZXkpCiAgICAgIGlmICh+c3Rh Y2suaW5kZXhPZih2YWx1ZSkpIHZhbHVlID0gY3ljbGVSZXBsYWNlci5jYWxsKHRoaXMsIGtleSwg dmFsdWUpCiAgICB9CiAgICBlbHNlIHN0YWNrLnB1c2godmFsdWUpCgogICAgcmV0dXJuIHJlcGxh Y2VyID09IG51bGwgPyB2YWx1ZSA6IHJlcGxhY2VyLmNhbGwodGhpcywga2V5LCB2YWx1ZSkKICB9 Cn0KCn0se31dLDExOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKInVzZSBzdHJp Y3QiOwoKLyogaHR0cHM6Ly9wZW9wbGUubW96aWxsYS5vcmcvfmpvcmVuZG9yZmYvZXM2LWRyYWZ0 Lmh0bWwjc2VjLW9iamVjdC5pcyAqLwoKdmFyIE51bWJlcklzTmFOID0gZnVuY3Rpb24gKHZhbHVl KSB7CglyZXR1cm4gdmFsdWUgIT09IHZhbHVlOwp9OwoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlv biBpcyhhLCBiKSB7CglpZiAoYSA9PT0gMCAmJiBiID09PSAwKSB7CgkJcmV0dXJuIDEgLyBhID09 PSAxIC8gYjsKCX0gZWxzZSBpZiAoYSA9PT0gYikgewoJCXJldHVybiB0cnVlOwoJfSBlbHNlIGlm IChOdW1iZXJJc05hTihhKSAmJiBOdW1iZXJJc05hTihiKSkgewoJCXJldHVybiB0cnVlOwoJfQoJ cmV0dXJuIGZhbHNlOwp9OwoKCn0se31dLDEyOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBv cnRzKXsKJ3VzZSBzdHJpY3QnOwoKdmFyIGtleXNTaGltOwppZiAoIU9iamVjdC5rZXlzKSB7Cgkv LyBtb2RpZmllZCBmcm9tIGh0dHBzOi8vZ2l0aHViLmNvbS9lcy1zaGltcy9lczUtc2hpbQoJdmFy IGhhcyA9IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHk7Cgl2YXIgdG9TdHIgPSBPYmpl Y3QucHJvdG90eXBlLnRvU3RyaW5nOwoJdmFyIGlzQXJncyA9IHJlcXVpcmUoJy4vaXNBcmd1bWVu dHMnKTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBnbG9iYWwtcmVxdWlyZQoJdmFyIGlzRW51bWVy YWJsZSA9IE9iamVjdC5wcm90b3R5cGUucHJvcGVydHlJc0VudW1lcmFibGU7Cgl2YXIgaGFzRG9u dEVudW1CdWcgPSAhaXNFbnVtZXJhYmxlLmNhbGwoeyB0b1N0cmluZzogbnVsbCB9LCAndG9TdHJp bmcnKTsKCXZhciBoYXNQcm90b0VudW1CdWcgPSBpc0VudW1lcmFibGUuY2FsbChmdW5jdGlvbiAo KSB7fSwgJ3Byb3RvdHlwZScpOwoJdmFyIGRvbnRFbnVtcyA9IFsKCQkndG9TdHJpbmcnLAoJCSd0 b0xvY2FsZVN0cmluZycsCgkJJ3ZhbHVlT2YnLAoJCSdoYXNPd25Qcm9wZXJ0eScsCgkJJ2lzUHJv dG90eXBlT2YnLAoJCSdwcm9wZXJ0eUlzRW51bWVyYWJsZScsCgkJJ2NvbnN0cnVjdG9yJwoJXTsK CXZhciBlcXVhbHNDb25zdHJ1Y3RvclByb3RvdHlwZSA9IGZ1bmN0aW9uIChvKSB7CgkJdmFyIGN0 b3IgPSBvLmNvbnN0cnVjdG9yOwoJCXJldHVybiBjdG9yICYmIGN0b3IucHJvdG90eXBlID09PSBv OwoJfTsKCXZhciBleGNsdWRlZEtleXMgPSB7CgkJJGFwcGxpY2F0aW9uQ2FjaGU6IHRydWUsCgkJ JGNvbnNvbGU6IHRydWUsCgkJJGV4dGVybmFsOiB0cnVlLAoJCSRmcmFtZTogdHJ1ZSwKCQkkZnJh bWVFbGVtZW50OiB0cnVlLAoJCSRmcmFtZXM6IHRydWUsCgkJJGlubmVySGVpZ2h0OiB0cnVlLAoJ CSRpbm5lcldpZHRoOiB0cnVlLAoJCSRvbm1vemZ1bGxzY3JlZW5jaGFuZ2U6IHRydWUsCgkJJG9u bW96ZnVsbHNjcmVlbmVycm9yOiB0cnVlLAoJCSRvdXRlckhlaWdodDogdHJ1ZSwKCQkkb3V0ZXJX aWR0aDogdHJ1ZSwKCQkkcGFnZVhPZmZzZXQ6IHRydWUsCgkJJHBhZ2VZT2Zmc2V0OiB0cnVlLAoJ CSRwYXJlbnQ6IHRydWUsCgkJJHNjcm9sbExlZnQ6IHRydWUsCgkJJHNjcm9sbFRvcDogdHJ1ZSwK CQkkc2Nyb2xsWDogdHJ1ZSwKCQkkc2Nyb2xsWTogdHJ1ZSwKCQkkc2VsZjogdHJ1ZSwKCQkkd2Vi a2l0SW5kZXhlZERCOiB0cnVlLAoJCSR3ZWJraXRTdG9yYWdlSW5mbzogdHJ1ZSwKCQkkd2luZG93 OiB0cnVlCgl9OwoJdmFyIGhhc0F1dG9tYXRpb25FcXVhbGl0eUJ1ZyA9IChmdW5jdGlvbiAoKSB7 CgkJLyogZ2xvYmFsIHdpbmRvdyAqLwoJCWlmICh0eXBlb2Ygd2luZG93ID09PSAndW5kZWZpbmVk JykgeyByZXR1cm4gZmFsc2U7IH0KCQlmb3IgKHZhciBrIGluIHdpbmRvdykgewoJCQl0cnkgewoJ CQkJaWYgKCFleGNsdWRlZEtleXNbJyQnICsga10gJiYgaGFzLmNhbGwod2luZG93LCBrKSAmJiB3 aW5kb3dba10gIT09IG51bGwgJiYgdHlwZW9mIHdpbmRvd1trXSA9PT0gJ29iamVjdCcpIHsKCQkJ CQl0cnkgewoJCQkJCQllcXVhbHNDb25zdHJ1Y3RvclByb3RvdHlwZSh3aW5kb3dba10pOwoJCQkJ CX0gY2F0Y2ggKGUpIHsKCQkJCQkJcmV0dXJuIHRydWU7CgkJCQkJfQoJCQkJfQoJCQl9IGNhdGNo IChlKSB7CgkJCQlyZXR1cm4gdHJ1ZTsKCQkJfQoJCX0KCQlyZXR1cm4gZmFsc2U7Cgl9KCkpOwoJ dmFyIGVxdWFsc0NvbnN0cnVjdG9yUHJvdG90eXBlSWZOb3RCdWdneSA9IGZ1bmN0aW9uIChvKSB7 CgkJLyogZ2xvYmFsIHdpbmRvdyAqLwoJCWlmICh0eXBlb2Ygd2luZG93ID09PSAndW5kZWZpbmVk JyB8fCAhaGFzQXV0b21hdGlvbkVxdWFsaXR5QnVnKSB7CgkJCXJldHVybiBlcXVhbHNDb25zdHJ1 Y3RvclByb3RvdHlwZShvKTsKCQl9CgkJdHJ5IHsKCQkJcmV0dXJuIGVxdWFsc0NvbnN0cnVjdG9y UHJvdG90eXBlKG8pOwoJCX0gY2F0Y2ggKGUpIHsKCQkJcmV0dXJuIGZhbHNlOwoJCX0KCX07CgoJ a2V5c1NoaW0gPSBmdW5jdGlvbiBrZXlzKG9iamVjdCkgewoJCXZhciBpc09iamVjdCA9IG9iamVj dCAhPT0gbnVsbCAmJiB0eXBlb2Ygb2JqZWN0ID09PSAnb2JqZWN0JzsKCQl2YXIgaXNGdW5jdGlv biA9IHRvU3RyLmNhbGwob2JqZWN0KSA9PT0gJ1tvYmplY3QgRnVuY3Rpb25dJzsKCQl2YXIgaXNB cmd1bWVudHMgPSBpc0FyZ3Mob2JqZWN0KTsKCQl2YXIgaXNTdHJpbmcgPSBpc09iamVjdCAmJiB0 b1N0ci5jYWxsKG9iamVjdCkgPT09ICdbb2JqZWN0IFN0cmluZ10nOwoJCXZhciB0aGVLZXlzID0g W107CgoJCWlmICghaXNPYmplY3QgJiYgIWlzRnVuY3Rpb24gJiYgIWlzQXJndW1lbnRzKSB7CgkJ CXRocm93IG5ldyBUeXBlRXJyb3IoJ09iamVjdC5rZXlzIGNhbGxlZCBvbiBhIG5vbi1vYmplY3Qn KTsKCQl9CgoJCXZhciBza2lwUHJvdG8gPSBoYXNQcm90b0VudW1CdWcgJiYgaXNGdW5jdGlvbjsK CQlpZiAoaXNTdHJpbmcgJiYgb2JqZWN0Lmxlbmd0aCA+IDAgJiYgIWhhcy5jYWxsKG9iamVjdCwg MCkpIHsKCQkJZm9yICh2YXIgaSA9IDA7IGkgPCBvYmplY3QubGVuZ3RoOyArK2kpIHsKCQkJCXRo ZUtleXMucHVzaChTdHJpbmcoaSkpOwoJCQl9CgkJfQoKCQlpZiAoaXNBcmd1bWVudHMgJiYgb2Jq ZWN0Lmxlbmd0aCA+IDApIHsKCQkJZm9yICh2YXIgaiA9IDA7IGogPCBvYmplY3QubGVuZ3RoOyAr K2opIHsKCQkJCXRoZUtleXMucHVzaChTdHJpbmcoaikpOwoJCQl9CgkJfSBlbHNlIHsKCQkJZm9y ICh2YXIgbmFtZSBpbiBvYmplY3QpIHsKCQkJCWlmICghKHNraXBQcm90byAmJiBuYW1lID09PSAn cHJvdG90eXBlJykgJiYgaGFzLmNhbGwob2JqZWN0LCBuYW1lKSkgewoJCQkJCXRoZUtleXMucHVz aChTdHJpbmcobmFtZSkpOwoJCQkJfQoJCQl9CgkJfQoKCQlpZiAoaGFzRG9udEVudW1CdWcpIHsK CQkJdmFyIHNraXBDb25zdHJ1Y3RvciA9IGVxdWFsc0NvbnN0cnVjdG9yUHJvdG90eXBlSWZOb3RC dWdneShvYmplY3QpOwoKCQkJZm9yICh2YXIgayA9IDA7IGsgPCBkb250RW51bXMubGVuZ3RoOyAr K2spIHsKCQkJCWlmICghKHNraXBDb25zdHJ1Y3RvciAmJiBkb250RW51bXNba10gPT09ICdjb25z dHJ1Y3RvcicpICYmIGhhcy5jYWxsKG9iamVjdCwgZG9udEVudW1zW2tdKSkgewoJCQkJCXRoZUtl eXMucHVzaChkb250RW51bXNba10pOwoJCQkJfQoJCQl9CgkJfQoJCXJldHVybiB0aGVLZXlzOwoJ fTsKfQptb2R1bGUuZXhwb3J0cyA9IGtleXNTaGltOwoKfSx7Ii4vaXNBcmd1bWVudHMiOjE0fV0s MTM6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewondXNlIHN0cmljdCc7Cgp2YXIg c2xpY2UgPSBBcnJheS5wcm90b3R5cGUuc2xpY2U7CnZhciBpc0FyZ3MgPSByZXF1aXJlKCcuL2lz QXJndW1lbnRzJyk7Cgp2YXIgb3JpZ0tleXMgPSBPYmplY3Qua2V5czsKdmFyIGtleXNTaGltID0g b3JpZ0tleXMgPyBmdW5jdGlvbiBrZXlzKG8pIHsgcmV0dXJuIG9yaWdLZXlzKG8pOyB9IDogcmVx dWlyZSgnLi9pbXBsZW1lbnRhdGlvbicpOwoKdmFyIG9yaWdpbmFsS2V5cyA9IE9iamVjdC5rZXlz OwoKa2V5c1NoaW0uc2hpbSA9IGZ1bmN0aW9uIHNoaW1PYmplY3RLZXlzKCkgewoJaWYgKE9iamVj dC5rZXlzKSB7CgkJdmFyIGtleXNXb3Jrc1dpdGhBcmd1bWVudHMgPSAoZnVuY3Rpb24gKCkgewoJ CQkvLyBTYWZhcmkgNS4wIGJ1ZwoJCQl2YXIgYXJncyA9IE9iamVjdC5rZXlzKGFyZ3VtZW50cyk7 CgkJCXJldHVybiBhcmdzICYmIGFyZ3MubGVuZ3RoID09PSBhcmd1bWVudHMubGVuZ3RoOwoJCX0o MSwgMikpOwoJCWlmICgha2V5c1dvcmtzV2l0aEFyZ3VtZW50cykgewoJCQlPYmplY3Qua2V5cyA9 IGZ1bmN0aW9uIGtleXMob2JqZWN0KSB7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgZnVuYy1uYW1l LW1hdGNoaW5nCgkJCQlpZiAoaXNBcmdzKG9iamVjdCkpIHsKCQkJCQlyZXR1cm4gb3JpZ2luYWxL ZXlzKHNsaWNlLmNhbGwob2JqZWN0KSk7CgkJCQl9CgkJCQlyZXR1cm4gb3JpZ2luYWxLZXlzKG9i amVjdCk7CgkJCX07CgkJfQoJfSBlbHNlIHsKCQlPYmplY3Qua2V5cyA9IGtleXNTaGltOwoJfQoJ cmV0dXJuIE9iamVjdC5rZXlzIHx8IGtleXNTaGltOwp9OwoKbW9kdWxlLmV4cG9ydHMgPSBrZXlz U2hpbTsKCn0seyIuL2ltcGxlbWVudGF0aW9uIjoxMiwiLi9pc0FyZ3VtZW50cyI6MTR9XSwxNDpb ZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7Cid1c2Ugc3RyaWN0JzsKCnZhciB0b1N0 ciA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmc7Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9u IGlzQXJndW1lbnRzKHZhbHVlKSB7Cgl2YXIgc3RyID0gdG9TdHIuY2FsbCh2YWx1ZSk7Cgl2YXIg aXNBcmdzID0gc3RyID09PSAnW29iamVjdCBBcmd1bWVudHNdJzsKCWlmICghaXNBcmdzKSB7CgkJ aXNBcmdzID0gc3RyICE9PSAnW29iamVjdCBBcnJheV0nICYmCgkJCXZhbHVlICE9PSBudWxsICYm CgkJCXR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYKCQkJdHlwZW9mIHZhbHVlLmxlbmd0aCA9 PT0gJ251bWJlcicgJiYKCQkJdmFsdWUubGVuZ3RoID49IDAgJiYKCQkJdG9TdHIuY2FsbCh2YWx1 ZS5jYWxsZWUpID09PSAnW29iamVjdCBGdW5jdGlvbl0nOwoJfQoJcmV0dXJuIGlzQXJnczsKfTsK Cn0se31dLDE1OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKJ3VzZSBzdHJpY3Qn OwoKdmFyIHRvT2JqZWN0ID0gT2JqZWN0Owp2YXIgVHlwZUVyciA9IFR5cGVFcnJvcjsKCm1vZHVs ZS5leHBvcnRzID0gZnVuY3Rpb24gZmxhZ3MoKSB7CglpZiAodGhpcyAhPSBudWxsICYmIHRoaXMg IT09IHRvT2JqZWN0KHRoaXMpKSB7CgkJdGhyb3cgbmV3IFR5cGVFcnIoJ1JlZ0V4cC5wcm90b3R5 cGUuZmxhZ3MgZ2V0dGVyIGNhbGxlZCBvbiBub24tb2JqZWN0Jyk7Cgl9Cgl2YXIgcmVzdWx0ID0g Jyc7CglpZiAodGhpcy5nbG9iYWwpIHsKCQlyZXN1bHQgKz0gJ2cnOwoJfQoJaWYgKHRoaXMuaWdu b3JlQ2FzZSkgewoJCXJlc3VsdCArPSAnaSc7Cgl9CglpZiAodGhpcy5tdWx0aWxpbmUpIHsKCQly ZXN1bHQgKz0gJ20nOwoJfQoJaWYgKHRoaXMuZG90QWxsKSB7CgkJcmVzdWx0ICs9ICdzJzsKCX0K CWlmICh0aGlzLnVuaWNvZGUpIHsKCQlyZXN1bHQgKz0gJ3UnOwoJfQoJaWYgKHRoaXMuc3RpY2t5 KSB7CgkJcmVzdWx0ICs9ICd5JzsKCX0KCXJldHVybiByZXN1bHQ7Cn07Cgp9LHt9XSwxNjpbZnVu Y3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7Cid1c2Ugc3RyaWN0JzsKCnZhciBkZWZpbmUg PSByZXF1aXJlKCdkZWZpbmUtcHJvcGVydGllcycpOwoKdmFyIGltcGxlbWVudGF0aW9uID0gcmVx dWlyZSgnLi9pbXBsZW1lbnRhdGlvbicpOwp2YXIgZ2V0UG9seWZpbGwgPSByZXF1aXJlKCcuL3Bv bHlmaWxsJyk7CnZhciBzaGltID0gcmVxdWlyZSgnLi9zaGltJyk7Cgp2YXIgZmxhZ3NCb3VuZCA9 IEZ1bmN0aW9uLmNhbGwuYmluZChpbXBsZW1lbnRhdGlvbik7CgpkZWZpbmUoZmxhZ3NCb3VuZCwg ewoJZ2V0UG9seWZpbGw6IGdldFBvbHlmaWxsLAoJaW1wbGVtZW50YXRpb246IGltcGxlbWVudGF0 aW9uLAoJc2hpbTogc2hpbQp9KTsKCm1vZHVsZS5leHBvcnRzID0gZmxhZ3NCb3VuZDsKCn0seyIu L2ltcGxlbWVudGF0aW9uIjoxNSwiLi9wb2x5ZmlsbCI6MTcsIi4vc2hpbSI6MTgsImRlZmluZS1w cm9wZXJ0aWVzIjozfV0sMTc6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewondXNl IHN0cmljdCc7Cgp2YXIgaW1wbGVtZW50YXRpb24gPSByZXF1aXJlKCcuL2ltcGxlbWVudGF0aW9u Jyk7Cgp2YXIgc3VwcG9ydHNEZXNjcmlwdG9ycyA9IHJlcXVpcmUoJ2RlZmluZS1wcm9wZXJ0aWVz Jykuc3VwcG9ydHNEZXNjcmlwdG9yczsKdmFyIGdPUEQgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlE ZXNjcmlwdG9yOwp2YXIgVHlwZUVyciA9IFR5cGVFcnJvcjsKCm1vZHVsZS5leHBvcnRzID0gZnVu Y3Rpb24gZ2V0UG9seWZpbGwoKSB7CglpZiAoIXN1cHBvcnRzRGVzY3JpcHRvcnMpIHsKCQl0aHJv dyBuZXcgVHlwZUVycignUmVnRXhwLnByb3RvdHlwZS5mbGFncyByZXF1aXJlcyBhIHRydWUgRVM1 IGVudmlyb25tZW50IHRoYXQgc3VwcG9ydHMgcHJvcGVydHkgZGVzY3JpcHRvcnMnKTsKCX0KCWlm ICgvYS9taWcuZmxhZ3MgPT09ICdnaW0nKSB7CgkJdmFyIGRlc2NyaXB0b3IgPSBnT1BEKFJlZ0V4 cC5wcm90b3R5cGUsICdmbGFncycpOwoJCWlmIChkZXNjcmlwdG9yICYmIHR5cGVvZiBkZXNjcmlw dG9yLmdldCA9PT0gJ2Z1bmN0aW9uJyAmJiB0eXBlb2YgKC9hLykuZG90QWxsID09PSAnYm9vbGVh bicpIHsKCQkJcmV0dXJuIGRlc2NyaXB0b3IuZ2V0OwoJCX0KCX0KCXJldHVybiBpbXBsZW1lbnRh dGlvbjsKfTsKCn0seyIuL2ltcGxlbWVudGF0aW9uIjoxNSwiZGVmaW5lLXByb3BlcnRpZXMiOjN9 XSwxODpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7Cid1c2Ugc3RyaWN0JzsKCnZh ciBzdXBwb3J0c0Rlc2NyaXB0b3JzID0gcmVxdWlyZSgnZGVmaW5lLXByb3BlcnRpZXMnKS5zdXBw b3J0c0Rlc2NyaXB0b3JzOwp2YXIgZ2V0UG9seWZpbGwgPSByZXF1aXJlKCcuL3BvbHlmaWxsJyk7 CnZhciBnT1BEID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcjsKdmFyIGRlZmluZVBy b3BlcnR5ID0gT2JqZWN0LmRlZmluZVByb3BlcnR5Owp2YXIgVHlwZUVyciA9IFR5cGVFcnJvcjsK dmFyIGdldFByb3RvID0gT2JqZWN0LmdldFByb3RvdHlwZU9mOwp2YXIgcmVnZXggPSAvYS87Cgpt b2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIHNoaW1GbGFncygpIHsKCWlmICghc3VwcG9ydHNEZXNj cmlwdG9ycyB8fCAhZ2V0UHJvdG8pIHsKCQl0aHJvdyBuZXcgVHlwZUVycignUmVnRXhwLnByb3Rv dHlwZS5mbGFncyByZXF1aXJlcyBhIHRydWUgRVM1IGVudmlyb25tZW50IHRoYXQgc3VwcG9ydHMg cHJvcGVydHkgZGVzY3JpcHRvcnMnKTsKCX0KCXZhciBwb2x5ZmlsbCA9IGdldFBvbHlmaWxsKCk7 Cgl2YXIgcHJvdG8gPSBnZXRQcm90byhyZWdleCk7Cgl2YXIgZGVzY3JpcHRvciA9IGdPUEQocHJv dG8sICdmbGFncycpOwoJaWYgKCFkZXNjcmlwdG9yIHx8IGRlc2NyaXB0b3IuZ2V0ICE9PSBwb2x5 ZmlsbCkgewoJCWRlZmluZVByb3BlcnR5KHByb3RvLCAnZmxhZ3MnLCB7CgkJCWNvbmZpZ3VyYWJs ZTogdHJ1ZSwKCQkJZW51bWVyYWJsZTogZmFsc2UsCgkJCWdldDogcG9seWZpbGwKCQl9KTsKCX0K CXJldHVybiBwb2x5ZmlsbDsKfTsKCn0seyIuL3BvbHlmaWxsIjoxNywiZGVmaW5lLXByb3BlcnRp ZXMiOjN9XSwxOTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7CiJ1c2Ugc3RyaWN0 IjsKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTog dHJ1ZSB9KTsKdmFyIGFzc2VydF8xID0gcmVxdWlyZSgiQHF1ZW5rL3Rlc3QvbGliL2Fzc2VydCIp OwpkZXNjcmliZSgnYnV0dG9uJywgZnVuY3Rpb24gKCkgewogICAgZGVzY3JpYmUoJ2J1dHRvbjAn LCBmdW5jdGlvbiAoKSB7CiAgICAgICAgaXQoJ3Nob3VsZCBiZSBkaXNhYmxlZCcsIGZ1bmN0aW9u ICgpIHsKICAgICAgICAgICAgdmFyIGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnV0dG9u MCcpOwogICAgICAgICAgICBhc3NlcnRfMS5hc3NlcnQoZS5kaXNhYmxlZCkudHJ1ZSgpOwogICAg ICAgIH0pOwogICAgfSk7Cn0pOwoKfSx7IkBxdWVuay90ZXN0L2xpYi9hc3NlcnQiOjF9XX0se30s WzE5XSk7Cg=='
}
